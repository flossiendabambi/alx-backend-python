#!/bin/bash

set -e

echo "ğŸ“¦ Applying Blue Deployment"
kubectl apply -f blue_deployment.yaml

echo "ğŸ“¦ Applying Green Deployment"
kubectl apply -f green_deployment.yaml

echo "ğŸ” Switching service to Green (edit selector manually or in script if desired)"
kubectl apply -f kubeservice.yaml
echo "ğŸ” Checking logs for green deployment pods..."
GREEN_PODS=$(kubectl get pods -l app=django,version=green -o name)

for pod in $GREEN_PODS; do
  echo "ğŸ“„ Logs for $pod"
  kubectl logs $pod
done
